data <- read.csv("dataset26.csv")
head(data)
library(ggplot2)
library(tidyverse)
library(gt)
library(patchwork)
library(gridExtra)
library(moderndive)
library(skimr)
data$Income <- ifelse(data$Income == " <=50K", 0, 1)
data$Education <- as.factor(data$Education)
data$Marital_Status <- as.factor(data$Marital_Status)
data$Occupation <- as.factor(data$Occupation)
data$Sex <- as.factor(data$Sex)
data$Nationality <- as.factor(data$Nationality)
str(data)
model <- glm(Income ~ Age + Education + Marital_Status + Occupation + Sex + Hours_PW + Nationality,
data = data,
family = binomial)
summary(model)
predictions <- predict(model, type = "response")
predicted_class <- ifelse(predictions > 0.5, 1, 0)
table(predicted_class, data$Income)
accuracy <- mean(predicted_class == data$Income)
print(paste("Accuracy: ", accuracy))
coef_table <- summary(model)$coefficients
coef_df <- as.data.frame(coef_table)
coef_df$Variables <- rownames(coef_df)
ggplot(coef_df, aes(x = Variables, y = Estimate)) +
geom_bar(stat = "identity") +
coord_flip() +
theme_minimal() +
labs(title = "Model Coefficients (Log-Odds)", x = "Variables", y = "Log-Odds")
coef_table <- summary(model)$coefficients
coef_df <- as.data.frame(coef_table)
significant_vars <- coef_df[coef_df$`Pr(>|z|)` < 0.05, ]
ggplot(coef_df, aes(x = Variables, y = Estimate)) +
geom_bar(stat = "identity") +
coord_flip() +
theme_minimal() +
labs(title = "Model Coefficients (Log-Odds)", x = "Variables", y = "Log-Odds")
coef_table <- summary(model)$coefficients
coef_df <- as.data.frame(coef_table)
significant_vars <- coef_df[coef_df$`Pr(>|z|)` < 0.05, ]
ggplot(significant_vars, aes(x = Variables, y = Estimate)) +
geom_bar(stat = "identity") +
coord_flip() +
theme_minimal() +
labs(title = "Significant Model Coefficients (Log-Odds)", x = "Variables", y = "Log-Odds")
coef_table <- summary(model)$coefficients
coef_df <- as.data.frame(coef_table)
coef_df$Variables <- rownames(coef_df)
significant_vars <- coef_df[coef_df$`Pr(>|z|)` < 0.05, ]
ggplot(significant_vars, aes(x = Variables, y = Estimate)) +
geom_bar(stat = "identity") +
coord_flip() +
theme_minimal() +
labs(title = "Significant Model Coefficients (Log-Odds)", x = "Variables", y = "Log-Odds")
significant_vars
install.packages("pscl")
library(pscl)
model <- glm(Income ~ Age + Education + Marital_Status + Occupation + Sex + Hours_PW + Nationality,
data = data,
family = binomial)
summary(model)
stepwise_model <- step(full_model, direction = "both", trace = 0)
model <- glm(Income ~ Age + Education + Marital_Status + Occupation + Sex + Hours_PW + Nationality,
data = data,
family = binomial)
summary(model)
stepwise_model <- step(model, direction = "both", trace = 0)
summary(stepwise_model)
stepwise_aic <- AIC(stepwise_model)
print(paste("Stepwise AIC: ", stepwise_aic))
cor_matrix <- cor(data[, c("Age", "Education", "Marital_Status", "Occupation", "Sex", "Hours_PW", "Nationality")])
data_encoded <- model.matrix(~ Education + Marital_Status + Occupation + Sex + Nationality - 1, data = data)
cor_matrix_encoded <- cor(data_encoded)
print(cor_matrix_encoded)
View(cor_matrix_encoded)
num_data <- data[, sapply(data, is.numeric)]
cor_matrix <- cor(num_data)
print(cor_matrix)
summary(num_data)
View(data)
library(ggplot2)
library(tidyverse)
library(gt)
library(patchwork)
library(gridExtra)
library(moderndive)
library(skimr)
data <- read.csv('dataset26.csv', na.strings = '?,')
data <- na.omit(data)
data <- data %>%
mutate(across(2:ncol(data), ~ substr(.x, 1, nchar(.x) - 1)))
write.csv(data, 'cleaned_data.csv', row.names = FALSE)
data$Income <- ifelse(data$Income == " <=50K", 0, 1)
data$Education <- as.factor(data$Education)
data$Marital_Status <- as.factor(data$Marital_Status)
data$Occupation <- as.factor(data$Occupation)
data$Sex <- as.factor(data$Sex)
data$Nationality <- as.factor(data$Nationality)
str(data)
summary(data)
library(ggplot2)
library(tidyverse)
library(gt)
library(patchwork)
library(gridExtra)
library(moderndive)
library(skimr)
data <- read.csv('dataset26.csv', na.strings = '?,')
data <- na.omit(data)
data <- data %>%
mutate(across(2:ncol(data), ~ substr(.x, 1, nchar(.x) - 1)))
write.csv(data, 'cleaned_data.csv', row.names = FALSE)
data$Income <- ifelse(data$Income == "<=50", 0, 1)
data$Education <- as.factor(data$Education)
data$Marital_Status <- as.factor(data$Marital_Status)
data$Occupation <- as.factor(data$Occupation)
data$Sex <- as.factor(data$Sex)
data$Nationality <- as.factor(data$Nationality)
str(data)
cor_matrix <- cor(data[, c("Age", "Education", "Marital_Status", "Occupation", "Sex", "Hours_PW", "Nationality")])
num_data <- data[, sapply(data, is.numeric)]
cor_matrix <- cor(num_data)
print(cor_matrix)
data_encoded <- model.matrix(~ Education + Marital_Status + Occupation + Sex + Nationality - 1, data = data)
cor_matrix_encoded <- cor(data_encoded)
print(cor_matrix_encoded)
model <- glm(Income ~ Age + Education + Marital_Status + Occupation + Sex + Hours_PW + Nationality,
data = data,
family = binomial)
summary(model)
stepwise_model <- step(model, direction = "both", trace = 0)
summary(stepwise_model)
stepwise_aic <- AIC(stepwise_model)
print(paste("Stepwise AIC: ", stepwise_aic))
coef_table <- summary(model)$coefficients
coef_df <- as.data.frame(coef_table)
significant_vars <- coef_df[coef_df$`Pr(>|z|)` < 0.05, ]
significant_vars
install.packages("glmnet")
# 加载 glmnet 包
library(glmnet)
x <- as.matrix(data[, -which(names(data) == "Income")])
y <- data$Income
lasso_model <- glmnet(x, y, alpha = 1)
x <- data_encoded
y <- data$Income
lasso_model <- glmnet(x, y, alpha = 1)
cv_lasso <- cv.glmnet(x, y, alpha = 1)
print(paste("Best lambda: ", cv_lasso$lambda.min))
plot(cv_lasso)
final_lasso_model <- glmnet(x, y, alpha = 1, lambda = cv_lasso$lambda.min)
print(coef(final_lasso_model))
x <- cbind(data_encoded, data$Age)
y <- data$Income
lasso_model <- glmnet(x, y, alpha = 1)
cv_lasso <- cv.glmnet(x, y, alpha = 1)
print(paste("Best lambda: ", cv_lasso$lambda.min))
plot(cv_lasso)
final_lasso_model <- glmnet(x, y, alpha = 1, lambda = cv_lasso$lambda.min)
print(coef(final_lasso_model))
